extends ../layout/main

block content
  style.
    /* Livestream Detail Page Styles */
    .livestream-detail-page {
      background: linear-gradient(135deg, #f5f8fa 0%, #e9eef3 100%);
      min-height: 100vh;
      padding: 2rem 0;
    }
    
    /* Breadcrumb Styling */
    .breadcrumb-custom {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border-radius: 12px;
      padding: 1rem 1.25rem;
      margin-bottom: 2rem;
      border: 2px solid #e8edf2;
      animation: fadeInDown 0.6s ease-out;
    }
    
    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .breadcrumb-custom .breadcrumb-item {
      font-size: 0.95rem;
    }
    
    .breadcrumb-custom .breadcrumb-item a {
      color: #0095FF;
      text-decoration: none;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    
    .breadcrumb-custom .breadcrumb-item a:hover {
      color: #0B1F3F;
      text-decoration: underline;
    }
    
    .breadcrumb-custom .breadcrumb-item.active {
      color: #5a6c7d;
      font-weight: 600;
    }
    
    /* Back Button */
    .btn-back {
      background: white;
      border: 2px solid #e8edf2;
      color: #5a6c7d;
      padding: 0.75rem 1.5rem;
      border-radius: 12px;
      font-weight: 600;
      font-size: 0.95rem;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      text-decoration: none;
      margin-bottom: 2rem;
    }
    
    .btn-back:hover {
      background: #f8f9fa;
      border-color: #0095FF;
      color: #0095FF;
      transform: translateY(-2px);
    }
    
    /* Main Content Card */
    .main-content-card {
      background: white;
      border-radius: 20px;
      border: 2px solid #e8edf2;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
      overflow: hidden;
      animation: fadeInUp 0.6s ease-out 0.2s backwards;
    }
    
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* Live Badge */
    .live-badge {
      position: absolute;
      top: 1rem;
      left: 1rem;
      z-index: 10;
      background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      font-weight: 700;
      font-size: 0.85rem;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(220, 38, 38, 0); }
      100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0); }
    }
    
    /* Video Player Container */
    .video-player-container {
      position: relative;
      background: #0B1F3F;
      border-radius: 0;
      overflow: hidden;
    }
    
    .video-player {
      width: 100%;
      height: 100%;
      min-height: 400px;
      border: none;
    }
    
    /* Content Area */
    .content-area {
      padding: 2rem;
    }
    
    .livestream-title {
      font-family: 'Bebas Neue', cursive;
      font-size: 2.2rem;
      color: #0B1F3F;
      letter-spacing: 0.5px;
      margin-bottom: 1.5rem;
      line-height: 1.3;
    }
    
    /* Time Information */
    .time-info {
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
      margin-bottom: 1.5rem;
      padding-bottom: 1.5rem;
      border-bottom: 2px solid #e8edf2;
    }
    
    .time-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    
    .time-icon {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #f0f8ff 0%, #e0f2ff 100%);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .time-icon i {
      font-size: 1.25rem;
      color: #0095FF;
    }
    
    .time-content h6 {
      font-weight: 600;
      color: #5a6c7d;
      font-size: 0.85rem;
      margin-bottom: 0.25rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .time-content p {
      font-weight: 700;
      color: #0B1F3F;
      margin: 0;
      font-size: 0.95rem;
    }
    
    /* Description */
    .description-section {
      margin-top: 1.5rem;
    }
    
    .description-title {
      font-family: 'Bebas Neue', cursive;
      font-size: 1.5rem;
      color: #0B1F3F;
      letter-spacing: 0.5px;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .description-title i {
      color: #0095FF;
    }
    
    .description-text {
      color: #5a6c7d;
      line-height: 1.7;
      font-size: 1rem;
    }
    
    /* Sidebar Cards */
    .sidebar-card {
      background: white;
      border-radius: 20px;
      border: 2px solid #e8edf2;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
      margin-bottom: 1.5rem;
      overflow: hidden;
      animation: fadeInUp 0.6s ease-out;
    }
    
    .sidebar-card-header {
      background: linear-gradient(135deg, #0B1F3F 0%, #152844 100%);
      padding: 1.25rem 1.5rem;
      color: white;
    }
    
    .sidebar-card-header h5 {
      font-family: 'Bebas Neue', cursive;
      font-size: 1.5rem;
      letter-spacing: 0.5px;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    
    .sidebar-card-header h5 i {
      background: linear-gradient(135deg, #0095FF 0%, #34C7FF 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .sidebar-card-body {
      padding: 1.5rem;
    }
    
    /* Info Items */
    .info-item-sidebar {
      margin-bottom: 1.25rem;
      padding-bottom: 1.25rem;
      border-bottom: 1px solid #e8edf2;
    }
    
    .info-item-sidebar:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }
    
    .info-label {
      color: #5a6c7d;
      font-size: 0.85rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 0.5rem;
    }
    
    .info-value {
      color: #0B1F3F;
      font-weight: 700;
      font-size: 1rem;
      margin: 0;
    }
    
    /* Status Badge */
    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.6rem 1rem;
      border-radius: 8px;
      font-weight: 700;
      font-size: 0.9rem;
    }
    
    .status-live {
      background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
      color: #059669;
      border: 1px solid #a7f3d0;
    }
    
    .status-offline {
      background: linear-gradient(135deg, #e5e7eb 0%, #d1d5db 100%);
      color: #5a6c7d;
      border: 1px solid #d1d5db;
    }
    
    /* Share Card */
    .share-card {
      text-align: center;
    }
    
    .share-title {
      font-family: 'Bebas Neue', cursive;
      font-size: 1.5rem;
      color: #0B1F3F;
      letter-spacing: 0.5px;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }
    
    .share-title i {
      color: #0095FF;
    }
    
    .share-buttons {
      display: flex;
      gap: 0.75rem;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .share-btn {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      font-size: 1.25rem;
      transition: all 0.3s ease;
      border: 2px solid;
    }
    
    .share-facebook {
      background: white;
      border-color: #1877f2;
      color: #1877f2;
    }
    
    .share-facebook:hover {
      background: #1877f2;
      color: white;
      transform: translateY(-3px);
    }
    
    .share-twitter {
      background: white;
      border-color: #1da1f2;
      color: #1da1f2;
    }
    
    .share-twitter:hover {
      background: #1da1f2;
      color: white;
      transform: translateY(-3px);
    }
    
    .share-whatsapp {
      background: white;
      border-color: #25d366;
      color: #25d366;
    }
    
    .share-whatsapp:hover {
      background: #25d366;
      color: white;
      transform: translateY(-3px);
    }
    
    .share-link {
      background: white;
      border-color: #0095FF;
      color: #0095FF;
    }
    
    .share-link:hover {
      background: linear-gradient(135deg, #0095FF 0%, #34C7FF 100%);
      color: white;
      transform: translateY(-3px);
    }
    
    /* Error State */
    .error-state {
      text-align: center;
      padding: 4rem 2rem;
      color: white;
    }
    
    .error-state i {
      font-size: 4rem;
      margin-bottom: 1.5rem;
      background: linear-gradient(135deg, #0095FF 0%, #34C7FF 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .error-state h5 {
      font-family: 'Bebas Neue', cursive;
      font-size: 1.8rem;
      color: white;
      letter-spacing: 0.5px;
      margin-bottom: 1rem;
    }
    
    .error-state p {
      color: rgba(255, 255, 255, 0.8);
      margin-bottom: 1.5rem;
      font-size: 1rem;
    }
    
    .btn-platform {
      background: white;
      border: none;
      color: #0095FF;
      padding: 0.75rem 1.5rem;
      border-radius: 12px;
      font-weight: 600;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      text-decoration: none;
    }
    
    .btn-platform:hover {
      background: #f8f9fa;
      transform: translateY(-2px);
      color: #0B1F3F;
    }
    
    /* Responsive */
    @media (max-width: 991px) {
      .livestream-title {
        font-size: 1.8rem;
      }
      
      .content-area {
        padding: 1.5rem;
      }
      
      .sidebar-card-body {
        padding: 1.25rem;
      }
      
      .time-info {
        gap: 1rem;
      }
    }
    
    @media (max-width: 767px) {
      .livestream-detail-page {
        padding: 1.5rem 0;
      }
      
      .breadcrumb-custom {
        padding: 0.75rem 1rem;
      }
      
      .main-content-card,
      .sidebar-card {
        border-radius: 16px;
      }
      
      .video-player {
        min-height: 300px;
      }
      
      .time-info {
        flex-direction: column;
        gap: 1rem;
      }
      
      .livestream-title {
        font-size: 1.5rem;
      }
      
      .description-title {
        font-size: 1.3rem;
      }
      
      .sidebar-card-header h5 {
        font-size: 1.3rem;
      }
      
      .share-buttons {
        gap: 0.5rem;
      }
      
      .share-btn {
        width: 45px;
        height: 45px;
        font-size: 1.1rem;
      }
    }

  .livestream-detail-page
    .container
      // Breadcrumb
      nav.breadcrumb-custom(aria-label="breadcrumb")
        ol.breadcrumb.mb-0
          li.breadcrumb-item
            a(href="/") Home
          li.breadcrumb-item
            a(href="/livestreams") Livestreams
          li.breadcrumb-item.active(aria-current="page")= livestream.title

      // Back Button
      a.btn-back(href="javascript:history.back()")
        i.bi.bi-arrow-left
        span Kembali

      .row.g-4
        // Main Content Area
        .col-lg-8
          .main-content-card
            // Video Player Section
            .video-player-container
              if livestream.is_live
                .live-badge
                  i.bi.bi-circle-fill
                  span LIVE
              
              if embedUrl
                iframe.video-player(
                  src=embedUrl
                  allowfullscreen
                  frameborder="0"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                  loading="lazy"
                  title=livestream.title
                )
              else
                .error-state
                  i.bi.bi-play-circle
                  h5 Video tidak tersedia
                  p Livestream tidak dapat ditampilkan di halaman ini
                  a.btn-platform(
                    href=livestream.url,
                    target="_blank",
                    rel="noopener noreferrer"
                  )
                    i.bi.bi-box-arrow-up-right
                    span Buka di Platform Asli
            
            // Content Area
            .content-area
              h1.livestream-title= livestream.title
              
              // Time Information
              if livestream.start_time || livestream.end_time
                .time-info
                  if livestream.start_time
                    .time-item
                      .time-icon
                        i.bi.bi-calendar-event
                      .time-content
                        h6 Mulai
                        p= new Date(livestream.start_time).toLocaleString('id-ID', { dateStyle: 'long', timeStyle: 'short' })
                  
                  if livestream.end_time
                    .time-item
                      .time-icon
                        i.bi.bi-calendar-check
                      .time-content
                        h6 Selesai
                        p= new Date(livestream.end_time).toLocaleString('id-ID', { dateStyle: 'long', timeStyle: 'short' })
              
              // Description
              if livestream.description
                .description-section
                  h4.description-title
                    i.bi.bi-card-text
                    span Deskripsi
                  p.description-text= livestream.description

        // Sidebar
        .col-lg-4
          // Information Card
          .sidebar-card
            .sidebar-card-header
              h5
                i.bi.bi-info-circle
                span Informasi Livestream
            
            .sidebar-card-body
              if livestream.sport_name
                .info-item-sidebar
                  .info-label Cabang Olahraga
                  p.info-value= livestream.sport_name
              
              if livestream.event_title
                .info-item-sidebar
                  .info-label Event Terkait
                  p.info-value= livestream.event_title
              
              if livestream.match_title
                .info-item-sidebar
                  .info-label Pertandingan
                  p.info-value= livestream.match_title
              
              // Status
              .info-item-sidebar
                .info-label Status
                if livestream.is_live
                  span.status-badge.status-live
                    i.bi.bi-broadcast
                    span SEDANG LIVE
                else
                  span.status-badge.status-offline
                    i.bi.bi-stop-circle
                    span Tidak Live

          // Share Card
          .sidebar-card.share-card
            .sidebar-card-body
              h4.share-title
                i.bi.bi-share
                span Bagikan Livestream
              
              .share-buttons
                a.share-btn.share-facebook(
                  href=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(currentUrl)}`,
                  target="_blank",
                  title="Bagikan ke Facebook"
                )
                  i.bi.bi-facebook
                
                a.share-btn.share-twitter(
                  href=`https://twitter.com/intent/tweet?url=${encodeURIComponent(currentUrl)}&text=${encodeURIComponent(livestream.title)}`,
                  target="_blank",
                  title="Bagikan ke Twitter"
                )
                  i.bi.bi-twitter
                
                a.share-btn.share-whatsapp(
                  href=`https://wa.me/?text=${encodeURIComponent(livestream.title + ' - ' + currentUrl)}`,
                  target="_blank",
                  title="Bagikan ke WhatsApp"
                )
                  i.bi.bi-whatsapp
                
                button.share-btn.share-link(
                  onclick="copyToClipboard()",
                  title="Salin Link",
                  id="copyLinkBtn"
                )
                  i.bi.bi-link-45deg

  //- Custom JavaScript
  script.
    (function() {
      // Copy to clipboard functionality
      function copyToClipboard() {
        const url = window.location.href;
        navigator.clipboard.writeText(url).then(() => {
          const btn = document.getElementById('copyLinkBtn');
          const originalIcon = btn.innerHTML;
          btn.innerHTML = '<i class="bi bi-check-lg"></i>';
          btn.style.background = 'linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)';
          btn.style.color = '#059669';
          btn.style.borderColor = '#a7f3d0';
          
          setTimeout(() => {
            btn.innerHTML = originalIcon;
            btn.style.background = '';
            btn.style.color = '';
            btn.style.borderColor = '';
          }, 2000);
        }).catch(err => {
          console.error('Failed to copy: ', err);
          alert('Gagal menyalin link');
        });
      }

      // Check if livestream is live and update badge
      if (#{livestream.is_live ? true : false}) {
        const liveBadge = document.querySelector('.live-badge');
        if (liveBadge) {
          setInterval(() => {
            liveBadge.style.opacity = liveBadge.style.opacity === '0.5' ? '1' : '0.5';
          }, 1000);
        }
      }

      // Intersection Observer for animations
      if ('IntersectionObserver' in window) {
        const observer = new IntersectionObserver((entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.style.opacity = '1';
              entry.target.style.transform = 'translateY(0)';
            }
          });
        }, {
          threshold: 0.1,
          rootMargin: '0px 0px -50px 0px'
        });

        // Observe all cards
        document.querySelectorAll('.main-content-card, .sidebar-card').forEach((card) => {
          observer.observe(card);
        });
      }

      // Auto play video if it's live
      const videoIframe = document.querySelector('.video-player');
      if (videoIframe && #{livestream.is_live ? true : false}) {
        setTimeout(() => {
          videoIframe.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}', '*');
        }, 2000);
      }

      // Add loading state to platform link
      const platformLink = document.querySelector('.btn-platform');
      if (platformLink) {
        platformLink.addEventListener('click', function() {
          this.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Membuka...';
        });
      }
    })();